version: "3.9"

services:
  vault:
    image: vault:latest
    container_name: vault
    ports:
      - "8200:8200"
      - "8201:8201"
    environment:
      VAULT_LOCAL_CONFIG: |
        ui = true
        listener "tcp" {
          address = "0.0.0.0:8200"
          tls_cert_file = "/opt/vault/tls/tls.crt"
          tls_key_file  = "/opt/vault/tls/tls.key"
        }
        storage "file" {
          path = "/opt/vault/data"
        }
    volumes:
      - ./tls:/opt/vault/tls
      - ./data:/opt/vault/data
      - ./vault.hcl:/vault/config/vault.hcl
    command: "server -config=/vault/config/vault.hcl"
    restart: unless-stopped
